# วิธีเพิ่มร้านใหม่

ระบบนี้เป็น **Multi-tenant** โดยที่ **แต่ละ domain = 1 ร้าน** ดังนั้นการเพิ่มร้านใหม่มี 2 วิธี:

## วิธีที่ 1: ใช้ Worker Domain ใหม่ (แนะนำ)

แต่ละ Worker domain สามารถเป็นร้านได้ 1 ร้าน ดังนั้นถ้าต้องการร้านใหม่:

### ขั้นตอน:

1. **สร้าง Worker ใหม่** (หรือใช้ Worker ที่มีอยู่แต่ยังไม่มีร้าน)
   - ไปที่ Cloudflare Dashboard → Workers & Pages → Create → Worker
   - เชื่อมต่อ GitHub repository เดียวกัน
   - ตั้งค่าเหมือน Worker เดิม (D1, R2, SESSION_SECRET)

2. **เข้าหน้า Bootstrap**
   - เปิด URL ของ Worker ใหม่: `https://<worker-domain>.workers.dev/admin/bootstrap`
   - หรือ `https://<worker-domain>.workers.dev/admin` แล้วจะ redirect ไปที่ bootstrap

3. **กรอกข้อมูลร้าน**
   - **Domain**: ใส่ domain ของ Worker นี้ (เช่น `my-shop-2.xxx.workers.dev`)
   - **ชื่อร้าน (ลาว)**: เช่น `ຮ້ານທີ່ 2`
   - **ชื่อร้าน (English)**: เช่น `Shop 2`
   - **อีเมล**: อีเมลสำหรับเข้าสู่ระบบ (เช่น `admin2@example.com`)
   - **รหัสผ่าน**: รหัสผ่านอย่างน้อย 8 ตัว

4. **กด "สร้างร้าน"**
   - ระบบจะสร้างร้านและบัญชีผู้ดูแล
   - จากนั้นจะ redirect ไปหน้า login

5. **เข้าสู่ระบบ**
   - ใช้อีเมลและรหัสผ่านที่กรอกไว้
   - เริ่มตั้งค่าร้านได้เลย

---

## วิธีที่ 2: เพิ่มร้านใน Worker เดียวกัน (ต้องแก้โค้ด)

ถ้าต้องการให้ Worker เดียวกันรองรับหลายร้าน (หลาย domain):

### ขั้นตอน:

1. **ตั้งค่า Custom Domain ใน Cloudflare**
   - เพิ่ม custom domain ใหม่ใน Worker
   - หรือใช้ subdomain (เช่น `shop1.example.com`, `shop2.example.com`)

2. **เข้าหน้า Bootstrap ด้วย domain ใหม่**
   - เปิด `https://shop2.example.com/admin/bootstrap`
   - กรอกข้อมูลร้าน (ใช้ domain `shop2.example.com`)

3. **ระบบจะสร้างร้านใหม่**
   - แต่ละ domain จะเป็นร้านแยกกัน
   - ข้อมูลไม่ปะปนกัน (multi-tenant)

---

## หมายเหตุสำคัญ

⚠️ **Bootstrap จะทำงานได้เฉพาะเมื่อ:**
- Worker นั้นยังไม่มี users ในระบบเลย
- ถ้ามี users แล้ว จะต้องลบ users ทั้งหมดก่อน (หรือใช้ Worker ใหม่)

⚠️ **แต่ละร้านแยกกัน:**
- สินค้า, ออเดอร์, ข้อมูลร้าน แยกกันตาม `shop_id`
- ไม่สามารถเข้าถึงข้อมูลร้านอื่นได้

---

## คำถามที่พบบ่อย

**Q: ทำไม Bootstrap ไม่ทำงาน?**  
A: ตรวจสอบว่า Worker นั้นยังไม่มี users ในระบบ ถ้ามีแล้วต้องใช้ Worker ใหม่หรือลบ users ทั้งหมดก่อน

**Q: สามารถมีหลายร้านใน Worker เดียวได้ไหม?**  
A: ได้ แต่ต้องใช้ domain ต่างกัน (custom domain หรือ subdomain)

**Q: ข้อมูลร้านจะปะปนกันไหม?**  
A: ไม่ เพราะระบบใช้ `shop_id` แยกข้อมูลตาม domain

**Q: ต้อง deploy Worker ใหม่ทุกครั้งที่เพิ่มร้านไหม?**  
A: ไม่ต้อง ถ้าใช้ Worker เดิมแค่เพิ่ม custom domain และ bootstrap ด้วย domain ใหม่
